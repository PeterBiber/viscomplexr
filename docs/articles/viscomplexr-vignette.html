<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phase Portraits of Complex Valued Functions with the R Package *viscomplexr* • viscomplexr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Phase Portraits of Complex Valued Functions with the R Package *viscomplexr*">
<meta property="og:description" content="viscomplexr">
<meta property="og:image" content="https://peterbiber.github.io/viscomplexr/docs/_pkgdown/figure_banner_300dpi.png">
<meta property="og:image:alt" content="Phase portrait of of the function f(z)=sin(z^3/(z-1i+2))">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@biber_peter">
<meta name="twitter:site" content="@biber_peter">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">viscomplexr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/viscomplexr-vignette_for_website.html">Phase Portraits with viscomplexr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PeterBiber/viscomplexr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="viscomplexr-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="viscomplexr-vignette_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="viscomplexr-vignette_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Phase Portraits of Complex Valued Functions with the R Package <em>viscomplexr</em>
</h1>
                        <h4 class="author">Peter Biber</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PeterBiber/viscomplexr/blob/master/vignettes/viscomplexr-vignette.Rmd"><code>vignettes/viscomplexr-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>viscomplexr-vignette.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <strong>R</strong> package <em>viscomplexr</em> has been written as a visualization tool for complex valued functions. More precisely, it provides functionality for making <em>phase portraits</em> of such functions, following conventions described by Wegert in his book <em>Visual Complex Functions</em> <span class="citation">(Wegert 2012)</span>. Conceptually, the package is intended for being used inside the framework of <strong>R</strong>’s base graphics, i.e. users of this package can freely utilize all features of base graphics for obtaining an optimum result, be it for scientific or artistic purposes. This vignette is not at all an introduction to function theory or an exhaustive treatment of what can be done with phase portraits - I recommend Wegert’s book for an ideal combination of both; the purpose of this vignette is in fact to make the reader acquainted with the technical features the package provides in a step-by-step process.</p>
<p>Due to the size restriction of CRAN packages, the number of illustrations in this vignette is kept to a minimum. Readers are encouraged to run all code examples shown below (and hopefully enjoy what they see), but especially those where we explicitly invite them to do so.</p>
</div>
<div id="using-the-function-phaseportrait" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-function-phaseportrait" class="anchor"></a>Using the function <em>phasePortrait</em>
</h2>
<div id="visualizing-the-complex-plane" class="section level3">
<h3 class="hasAnchor">
<a href="#visualizing-the-complex-plane" class="anchor"></a>Visualizing the complex plane</h3>
<p>The package does not contain many functions, but provides a very versatile workhorse called <em>phasePortrait</em>. We will explore some of its key features now. Let us first consider a function that maps a complex number <span class="math inline">\(z \in \mathbb{C}\)</span> on itself, i.e. <span class="math inline">\(f(z)=z\)</span>. After attaching the package with <code><a href="https://peterbiber.github.io/viscomplexr">library(viscomplexr)</a></code>, a phase portrait of this function is obtained very easily with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"z"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>,
              xlab <span class="op">=</span> <span class="st">"real"</span>, ylab <span class="op">=</span> <span class="st">"imaginary"</span>, main <span class="op">=</span> <span class="st">"f(z) = z"</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Probably not required on your machine (see below)</span>

<span class="co"># Note the argument 'nCores' which determines the number of parallel processes to</span>
<span class="co"># be used. Setting nCores = 2 has been done here and in all subsequent </span>
<span class="co"># examples as CRAN checks do not allow more parallel processes. </span>
<span class="co"># For normal work, we recommend not to define nCores at all which will make </span>
<span class="co"># phasePortrait use all available cores on your machine.</span>

<span class="co"># The progress messages phasePortrait is writing to the console can be </span>
<span class="co"># suppressed by including 'verbose = FALSE' in the call (see documentation).</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="viscomplexr-vignette_files/figure-html/figure_1-1.png" alt="Phase portrait of the function $f(z)=z$ in the window $\left|\Re(z)\right| &lt; 8.5$ and $\left|\Im(z)\right| &lt; 8.5$." width="480"><p class="caption">
Phase portrait of the function <span class="math inline">\(f(z)=z\)</span> in the window <span class="math inline">\(\left|\Re(z)\right| &lt; 8.5\)</span> and <span class="math inline">\(\left|\Im(z)\right| &lt; 8.5\)</span>.
</p>
</div>
<p>Such a phase portrait is based on the polar representation of complex numbers. Any complex number <span class="math inline">\(z\)</span> can be written as <span class="math inline">\(z=r\cdot\mathrm{e}^{\mathrm{i}\varphi}\)</span> or equivalently <span class="math inline">\(z=r\cdot(\cos\varphi+\mathrm{i}\cdot\sin\varphi)\)</span>, whereby <span class="math inline">\(r\)</span> is the <em>modulus</em> and the angle <span class="math inline">\(\varphi\)</span> is the <em>argument</em>. The argument, also called the <em>phase angle</em>, is the angle in the origin of the complex number plane between the real axis and the position vector of the number in counter-clockwise orientation. The main feature of a phase portrait is to translate the argument into a color. In addition, there are options for visualizing the modulus or, more precisely, its relative change.</p>
<p>The translation of the phase angle <span class="math inline">\(\varphi\)</span> into a color follows the <a href="https://en.wikipedia.org/wiki/HSL_and_HSV">hsv color model</a>, where radian values of <span class="math inline">\(\varphi=0+k\cdot2\pi\)</span>, <span class="math inline">\(\varphi=\frac{2\pi}{3}+k\cdot2\pi\)</span>, and <span class="math inline">\(\varphi=\frac{4\pi}{3}+k\cdot2\pi\)</span> with <span class="math inline">\(k\in\mathbb{Z}\)</span> translate into the colors red, green, and blue, respectively, with a continuous transition of colors with values between. As all numbers with the same argument <span class="math inline">\(\varphi\)</span> obtain the same color, the numbers of the complex plane as visualized in the Figure above are colored along the chromatic cycle. In order to add visual structure, argument values of <span class="math inline">\(\varphi=\frac{2\pi}{9}\)</span>, i.e. <span class="math inline">\(40°\)</span> and their integer multiples are emphasized by black lines. Note that each of these lines follows exactly one color. Moreover, the zones between two neighboring arguments <span class="math inline">\(\varphi_1=k\cdot\frac{2\pi}{9}\)</span> and <span class="math inline">\(\varphi_2=(k+1)\cdot\frac{2\pi}{9}\)</span> with <span class="math inline">\(k\in\mathbb{Z}\)</span> are shaded in a way that the brightness of the colors inside one such zone increases with increasing <span class="math inline">\(\varphi\)</span>, i.e. in counterclockwise sense of rotation.</p>
<p>The other lines visible in the figure above relate to the modulus <span class="math inline">\(r\)</span>. One such line follows the same value of <span class="math inline">\(r\)</span>; it is thus obvious that each of these iso-modulus lines must form a concentric circle on the complex number plane (see the figure above). The distance between neighboring iso-modulus lines is chosen so that it always indicates the same relative change. For reasons to talk about later <span class="citation">(see also Wegert 2012)</span>, the default setting of the function <em>phasePortrait</em> is a relative change of <span class="math inline">\(b=\mathrm{e}^{2\pi/9}\)</span> which is very close to <span class="math inline">\(2\)</span>. Thus, with a grain of salt, the modulus of the complex numbers doubles or halves when moving from one iso-modulus line to the other. In the phase portrait, the zones between two adjacent iso-modulus lines are shaded in a way that the colors inside such a zone become brighter in the direction of increasing modulus. The lines themselves are located at the moduli <span class="math inline">\(r=b^k\)</span>, with <span class="math inline">\(k\in\mathbb{Z}\)</span>. This is nicely visible in the phase portrait above, where the outmost circular iso-modulus line indicates (approximately, as <span class="math inline">\(b\)</span> is not exactly <span class="math inline">\(2\)</span>) <span class="math inline">\(r=2^3=8\)</span>. Moving inwards, the following iso-modulus lines are at (approximately) <span class="math inline">\(r=2^2=4\)</span>, <span class="math inline">\(r=2^1=2\)</span>, <span class="math inline">\(r=2^0=1\)</span>, <span class="math inline">\(r=2^{-1}=\frac{1}{2}\)</span>, <span class="math inline">\(r=2^{-2}=\frac{1}{4}\)</span>, etc. Obviously, as the modulus of the numbers on the complex plane is their distance from the origin, the width of the concentric rings formed by adjacent iso-modulus lines approximately doubles from ring to ring when moving outwards.</p>
</div>
<div id="visual-structuring---the-argument-ptype" class="section level3">
<h3 class="hasAnchor">
<a href="#visual-structuring---the-argument-ptype" class="anchor"></a>Visual structuring - the argument <em>pType</em>
</h3>
<p>When working with the function <em>phasePortrait</em>, it might not always be desirable to display all of these reference lines and zonings. The argument <code>pType</code> allows for four different options as illustrated in the next example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># divide graphics device into four regions and adjust plot margins </span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, 
          mar   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.55</span>, <span class="fl">1.10</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span> 
<span class="co"># plot four phase portraits with different choices of pType</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"z"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, pType <span class="op">=</span> <span class="st">"p"</span>,
              main <span class="op">=</span> <span class="st">"pType = 'p'"</span>,   axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"z"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, pType <span class="op">=</span> <span class="st">"pa"</span>,
              main <span class="op">=</span> <span class="st">"pType = 'pa'"</span>,  axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"z"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, pType <span class="op">=</span> <span class="st">"pm"</span>,
              main <span class="op">=</span> <span class="st">"pType = 'pm'"</span>,  axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"z"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, pType <span class="op">=</span> <span class="st">"pma"</span>,
              main <span class="op">=</span> <span class="st">"pType = 'pma'"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span> <span class="co"># reset the graphics parameters to their previous values</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="viscomplexr-vignette_files/figure-html/figure_2-1.png" alt="Different options for including reference lines with the argument `pType`." width="480"><p class="caption">
Different options for including reference lines with the argument <code>pType</code>.
</p>
</div>
<p>As evident from the figure above, setting <code>ptype</code> to ‘p’ displays a phase portrait in the literal sense, i.e. only the phase of the complex numbers is displayed and nothing else. The option ‘pa’ adds reference lines for the argument, the option ‘pm’ adds iso-modulus lines, and the (default) option ‘pma’ adds both. In addition to these options, the example shows <em>phasePortrait</em> in combination with <strong>R</strong>’s base graphics. The first and the last line of the code chunk set and reset global graphics parameters, and inside the calls to <em>phasePortrait</em>, we use the arguments <code>main</code> (diagram title) and <code>axes</code> which are generic plot arguments.</p>
</div>
<div id="visual-structuring---the-arguments-pi2div-and-logbase" class="section level3">
<h3 class="hasAnchor">
<a href="#visual-structuring---the-arguments-pi2div-and-logbase" class="anchor"></a>Visual structuring - the arguments <em>pi2Div</em> and <em>logBase</em>
</h3>
<p>For demonstrating options to adjust the density of the argument and modulus reference lines, consider the rational function <span class="math display">\[
f(z)=\frac{(3+2\mathrm{i}+z)(-5+5\mathrm{i}+z)}{(-2-2\mathrm{i}+z)^2}
\]</span> Evidently, this function has two zeroes, <span class="math inline">\(z_1=-3-2\mathrm{i}\)</span>, and <span class="math inline">\(z_2=5-5\mathrm{i}\)</span>. It also has a second order pole at <span class="math inline">\(z_3=2+2\mathrm{i}\)</span>. We make a phase portrait of this function over the same cutout of the complex plane as we did in the figures above. When calling <em>phasePortrait</em> with such simple functions, it is most convenient to define them as as a quoted character string in <strong>R</strong> syntax containing the variable <span class="math inline">\(z\)</span>. Run the code below for displaying the phase portrait (active 7" x 7" screen graphics device suggested, e.g. <code><a href="https://rdrr.io/r/grDevices/x11.html">x11()</a></code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="co"># adjust plot margins </span>
                                                  <span class="co"># and general text size</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"(3+2i+z)*(-5+5i+z)/(-2-2i+z)^2"</span>, 
              xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>,
              xlab <span class="op">=</span> <span class="st">"real"</span>, ylab <span class="op">=</span> <span class="st">"imaginary"</span>, 
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span> <span class="co"># reset the graphics parameters to their previous values</span></code></pre></div>
<p>The resulting figure nicely displays the function’s two zeroes and the pole. Note that all colors meet in zeroes and poles. Around zeroes, the colors cycle counterclockwise in the order red, green, blue, while this order is reversed around poles. For <span class="math inline">\(n\)</span><sup>th</sup> order (<span class="math inline">\(n\in\mathbb{N}\)</span>) zeroes and poles, the cycle is passed through <span class="math inline">\(n\)</span> times. I recommend to check this out with examples of your own.</p>
<p>Now, suppose we want to change the density of the reference lines for the phase angle <span class="math inline">\(\varphi\)</span>. This can be done by way of the argument <code>pi2Div</code>. For usual applications, <code>pi2Div</code> should be a natural number <span class="math inline">\(n\:(n\in\mathbb{N})\)</span>. It defines the angle <span class="math inline">\(\Delta\varphi\)</span> between two adjacent reference lines as a fraction of the round angle, i.e. <span class="math inline">\(\Delta\varphi=\frac{2\pi}{n}\)</span>. The default value of <code>pi2Div</code> is 9, i.e. <span class="math inline">\(\Delta\varphi=\frac{2\pi}{9}=40°\)</span>. Let’s plot our function in three flavors of <code>pi2Div</code>, namely, 6, 9 (the default), and 18, resulting in <span class="math inline">\(\Delta\varphi\)</span> values of <span class="math inline">\(\frac{\pi}{3}=60°\)</span>, <span class="math inline">\(\frac{2\pi}{9}=40°\)</span>, and <span class="math inline">\(\frac{\pi}{9}=20°\)</span>. In order to suppress the iso-modulus lines and display the argument reference lines only, we are using <code>pType = "pa"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># divide graphics device into three regions and adjust plot margins </span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"(3+2i+z)*(-5+5i+z)/(-2-2i+z)^2"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>,
                pi2Div <span class="op">=</span> <span class="va">n</span>, pType <span class="op">=</span> <span class="st">"pa"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="co"># separate title call (R base graphics) for nicer line adjustment, just cosmetics</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"pi2Div ="</span>, <span class="va">n</span><span class="op">)</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1.2</span><span class="op">)</span> 
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span> <span class="co"># reset graphics parameters to previous values</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="viscomplexr-vignette_files/figure-html/figure_4-1.png" alt='The function $f(z)=\frac{(3+2\mathrm{i}+z)(-5+5\mathrm{i}+z)}{(-2-2\mathrm{i}+z)^2}$ portrayed with three different settings of `pi2Div` and `pType = "pa"`.' width="672"><p class="caption">
The function <span class="math inline">\(f(z)=\frac{(3+2\mathrm{i}+z)(-5+5\mathrm{i}+z)}{(-2-2\mathrm{i}+z)^2}\)</span> portrayed with three different settings of <code>pi2Div</code> and <code>pType = "pa"</code>.
</p>
</div>
<p>So far, this is exactly, what had to be expected. But see what happens when we choose the default <code>pType</code>, <code>"pma"</code> which also adds modulus reference lines:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># divide graphics device into three regions and adjust plot margins </span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"(3+2i+z)*(-5+5i+z)/(-2-2i+z)^2"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>,
                pi2Div <span class="op">=</span> <span class="va">n</span>, pType <span class="op">=</span> <span class="st">"pma"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="co"># separate title call (R base graphics) for nicer line adjustment, just cosmetics</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"pi2Div ="</span>, <span class="va">n</span><span class="op">)</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1.2</span><span class="op">)</span> 
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span> <span class="co"># reset graphics parameters to previous values</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="viscomplexr-vignette_files/figure-html/figure_5-1.png" alt='The function $f(z)=\frac{(3+2\mathrm{i}+z)(-5+5\mathrm{i}+z)}{(-2-2\mathrm{i}+z)^2}$ portrayed with three different settings of `pi2Div` and `pType = "pma"`.' width="672"><p class="caption">
The function <span class="math inline">\(f(z)=\frac{(3+2\mathrm{i}+z)(-5+5\mathrm{i}+z)}{(-2-2\mathrm{i}+z)^2}\)</span> portrayed with three different settings of <code>pi2Div</code> and <code>pType = "pma"</code>.
</p>
</div>
<p>Evidently, the choice of <code>pi2Div</code> has influenced the density of the iso-modulus lines. This is because, by default, the parameter <code>logBase</code>, which controls how dense the iso-modulus lines are arranged, is linked to <code>pi2Div</code>. As stated above, <code>pi2Div</code> is usually a natural number <span class="math inline">\(n\:(n \in\mathbb{N})\)</span>, and <code>logBase</code> is the real number <span class="math inline">\(b\:(b\in\mathbb{R})\)</span> which defines the moduli <span class="math inline">\(r=b^k\:(k\in\mathbb{Z})\)</span> where the reference lines are drawn. When <span class="math inline">\(n\)</span> is given, the default definition of <span class="math inline">\(b\)</span> is <span class="math inline">\(b=\mathrm{e}^{2\pi/n}\)</span>. In the default case, <span class="math inline">\(n=9\)</span>, this results in <span class="math inline">\(b\approx2.009994\)</span>. Thus, by default, moving from one iso-modulus line to the adjacent one means almost exactly doubling or halving the modulus, depending on the direction. For the other two cases <span class="math inline">\(n=6\)</span> and <span class="math inline">\(n=18\)</span>, the resulting values for <span class="math inline">\(b\)</span> are <span class="math inline">\(b\approx2.85\)</span> and <span class="math inline">\(b\approx1.42\)</span>, the latter obviously being the square root of <span class="math inline">\(\mathrm{e}^{2\pi/9}\)</span>. For <span class="math inline">\(n=9\)</span>, the modulus (approximately) doubles or halves when traversing two adjacent iso-modulus lines.</p>
<p>Before we demonstrate the special property of this linkage between <span class="math inline">\(n\)</span> and <span class="math inline">\(b\)</span>, i.e. between <code>pi2Div</code> and <code>logBase</code>, we shortly show, that they can be decoupled in <em>phasePortrait</em> without any complication. In the following example, we want to define the density of the iso-modulus lines in a way that the modulus triples when traversing three zones in the direction of ascending moduli. Clearly, this requires to define <code>logBase</code> as <span class="math inline">\(b=\sqrt[3]{3}\approx1.44\)</span>. Thus, when moving from one iso-modulus line to the next higher one, the modulus has increased by a factor of about <span class="math inline">\(1.4\)</span>. One line further, it has about doubled (<span class="math inline">\({\sqrt[3]{3}}^{2}\approx2.08\)</span>), and another line further it has exactly tripled. While varying <code>pi2Div</code> exactly as in the previous example, we now keep <code>logBase</code> constant at <span class="math inline">\(\sqrt[3]{3}\)</span>. Run the code below for visualizing this (active 7" x 2.8" screen graphics device suggested, e.g. <code><a href="https://rdrr.io/r/grDevices/x11.html">x11(width = 7, height = 2.8)</a></code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># divide graphics device into three regions and adjust plot margins </span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"(3+2i+z)*(-5+5i+z)/(-2-2i+z)^2"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>,
                pi2Div <span class="op">=</span> <span class="va">n</span>, logBase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, pType <span class="op">=</span> <span class="st">"pma"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="co"># separate title call (R base graphics) for nicer line adjustment, just cosmetics</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"pi2Div = "</span>, <span class="va">n</span>, <span class="st">", logBase = 3^(1/3)"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1.2</span><span class="op">)</span> 
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span> <span class="co"># reset graphics parameters to previous values</span></code></pre></div>
<p>In order to understand why by default the parameters <code>pi2Div</code> and <code>logBase</code> are linked as described above, we consider the exponential function <span class="math inline">\(f(z)=\mathrm{e}^z\)</span>. We can write <span class="math inline">\(z=r\cdot(\cos\varphi+\mathrm{i}\cdot\sin\varphi)\)</span> and thus <span class="math inline">\(f(z)=\mathrm{e}^{r\cdot(\cos\varphi+\mathrm{i}\cdot\sin\varphi)}\)</span> or <span class="math inline">\(w=f(z)=\mathrm{e}^{r\cdot\cos\varphi}\cdot\mathrm{e}^{\mathrm{i}\cdot r\cdot\sin\varphi}\)</span>. The modulus of <span class="math inline">\(w\)</span> is <span class="math inline">\(\mathrm{e}^{r\cdot\cos\varphi}\)</span> and its argument is <span class="math inline">\(r\cdot\sin\varphi\)</span> with <span class="math inline">\(\Re(z)=r\cdot\cos\varphi\)</span> and <span class="math inline">\(\Im(z)=r\cdot \sin\varphi\)</span>. So, the modulus and the argument of <span class="math inline">\(w=\mathrm{e}^z\)</span> depend solely on the real and the imaginary part of <span class="math inline">\(z\)</span>, respectively. This can be easily verified with a phase portrait of <span class="math inline">\(f(z)=\mathrm{e}^z\)</span>. Run the code below for displaying the phase portrait (active 7" x 7" screen graphics device suggested, e.g. <code><a href="https://rdrr.io/r/grDevices/x11.html">x11()</a></code>). Note that in the call to <em>phasePortrait</em> we hand over the <code>exp</code> function directly as an object. Alternatively, the quoted strings <code>"exp(z)"</code> or <code>"exp"</code> can be used as well (see section <a href="#ways_functions">ways to provide functions to <em>phasePortrait</em></a> below).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="co"># adjust plot margins </span>
                                                  <span class="co"># and general text size</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">exp</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, pType <span class="op">=</span> <span class="st">"pm"</span>,
              xlab <span class="op">=</span> <span class="st">"real"</span>, ylab <span class="op">=</span> <span class="st">"imaginary"</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span> <span class="co"># reset graphics parameters to previous values                         </span></code></pre></div>
<p>If we now define the argument <code>pi2Div</code> as a number <span class="math inline">\(n\:(n\in\mathbb{N})\)</span> and use it for determining the angular difference <span class="math inline">\(\Delta\varphi=\frac{2\pi}{n}\)</span> between two subsequent phase angle reference lines, our default link between <code>pi2Div</code> and <code>logBase</code> (which is the ratio <span class="math inline">\(b\)</span> of the moduli at two subsequent iso-modulus lines) establishes <span class="math inline">\(b=\mathrm{e}^{\Delta\varphi}\)</span>. This means, if we add <span class="math inline">\(\Delta\varphi\)</span> to the argument of any <span class="math inline">\(w=\mathrm{e}^z\:(z\in\mathbb{C})\)</span> or increase its modulus by the factor <span class="math inline">\(\mathrm{e}^{\Delta\varphi}\)</span>, both are equidistant reference line steps in a plot of <span class="math inline">\(f(z)=\mathrm{e}^z\)</span>. We visualize this with the following <strong>R</strong> code:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># divide graphics device into three regions and adjust plot margins </span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"exp(z)"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>, <span class="fl">8.5</span><span class="op">)</span>,
                pi2Div <span class="op">=</span> <span class="va">n</span>, pType <span class="op">=</span> <span class="st">"pma"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="co"># separate title call (R base graphics) for nicer line adjustment, just cosmetics</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"pi2Div = "</span>, <span class="va">n</span>, <span class="st">", logBase = exp(2*pi/pi2Div)"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, 
        line <span class="op">=</span> <span class="op">-</span><span class="fl">1.2</span>, cex.main <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> 
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span> <span class="co"># reset graphics parameters to previous values</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="viscomplexr-vignette_files/figure-html/figure_8-1.png" alt="The function $f(z)=\mathrm{e}^z$ portrayed with the default coupling of `pi2Div` and `logBase` as implemented in *phasePortrait*." width="672"><p class="caption">
The function <span class="math inline">\(f(z)=\mathrm{e}^z\)</span> portrayed with the default coupling of <code>pi2Div</code> and <code>logBase</code> as implemented in <em>phasePortrait</em>.
</p>
</div>
<p>As expected, the default coupling of both arguments produces square patterns when applied to a phase portrait of the exponential function which can, insofar, serve as a visual reference. Recall, that equidistant modulus reference lines (in ascending order) indicate an exponentially growing modulus. In the middle phase portrait one such steps means (approximately) doubling the modulus. From the left to the right, the plot covers 24 of these steps, indicating a total increase of the modulus by factor <span class="math inline">\(2^{24}\)</span> which amounts to almost 17 millions.</p>
</div>
<div id="fine-tuning-shading-and-contrast" class="section level3">
<h3 class="hasAnchor">
<a href="#fine-tuning-shading-and-contrast" class="anchor"></a>Fine tuning shading and contrast</h3>
<p>For optimizing visualization in a technical sense, as well as for aesthetic purposes, it may be useful to adjust shading and contrast of the argument and modulus reference zones mentioned above. This is done by modifying the parameters <code>darkestShade</code> (<span class="math inline">\(s\)</span>) and <code>lambda</code> (<span class="math inline">\(\lambda\)</span>) when calling <code>phasePortrait</code>. These two parameters can be used to steer the transition from the lower to the uper edge of a reference zone. They address the v-value of the <a href="https://en.wikipedia.org/wiki/HSL_and_HSV">hsv color model</a>, which can take values between 0 and 1, indicating maximum darkness (black), and no shading at all, respectively. Hereby, <span class="math inline">\(s\)</span> gives the v-value at the lower edge of a reference zone, and <span class="math inline">\(\lambda\)</span> determines the interpolation from there to the upper edge, where no shading is applied. The intended use is <span class="math inline">\(\lambda &gt; 0\)</span> where small values sharpen the contrast between shaded and non-shaded zones and vice versa. Exactly, the shading value <span class="math inline">\(v\)</span> is calculated as: <span class="math display">\[
v = s + (1-s)\cdot x^{1/\lambda}
\]</span> For modulus zone shading at a point <span class="math inline">\(z\)</span> in the complex plane when portraying a function <span class="math inline">\(f(z)\)</span>, <span class="math inline">\(x\)</span> is the fractional part of <span class="math inline">\(\log_b{f(z)}\)</span>, with the base <span class="math inline">\(b\)</span> being the parameter <code>logBase</code> that defines the modulus reference zoning (see above). For shading argument reference zones, <span class="math inline">\(x\)</span> is simply the difference between the upper and the lower angle of an argument reference zone, linearly mapped to the range <span class="math inline">\([0, 1[\)</span>. The following code generates a <span class="math inline">\(3\times3\)</span> matrix of phase portraits of <span class="math inline">\(f(z)=\tan{z^2}\)</span> with <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(s\)</span> changing along the rows and columns, respectively. Run the code for visualizing these concepts (active 7" x 7" screen graphics device suggested, e.g. <code><a href="https://rdrr.io/r/grDevices/x11.html">x11()</a></code>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">lb</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">dS</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"tan(z^2)"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.7</span>, <span class="fl">1.7</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.7</span>, <span class="fl">1.7</span><span class="op">)</span>, 
                  pType <span class="op">=</span> <span class="st">"pm"</span>, darkestShade <span class="op">=</span> <span class="va">dS</span>, lambda <span class="op">=</span> <span class="va">lb</span>, 
                  axes <span class="op">=</span> <span class="cn">FALSE</span>, xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<p>Additional possibilities exist for tuning the interplay of modulus and argument reference zones when they are used in combination; this can be controlled with the parameter <code>gamma</code> when calling <code>phasePortrait</code>). The maximum brightness of the colours in a phase portrait is adjustable with the parameter <code>stdSaturation</code> (see documentation of <code>phasePortrait</code>; we will also get back to these points in the chapter <a href="#hints_artistic">aesthetic hints</a> below).</p>
</div>
<div id="be-aware-of-branch-cuts" class="section level3">
<h3 class="hasAnchor">
<a href="#be-aware-of-branch-cuts" class="anchor"></a>Be aware of branch cuts</h3>
<p>When exploring functions with <em>phasePortrait</em>, discontinuities of certain functions can become visible as abrupt color changes. Typical examples are integer root functions which, for a given point <span class="math inline">\(z, z\in\mathbb{C}\setminus\lbrace0\rbrace\)</span> in the complex plane, can attain <span class="math inline">\(n\)</span> values with <span class="math inline">\(n\)</span> being the root’s degree. It takes, so to speak, <span class="math inline">\(n\)</span> full cycles around the origin of the complex plane in order to cover all values obtained from a function <span class="math inline">\(f(z)=z^{1/n}, n\in\mathbb{N}\)</span>. This is illustrated for the third root function in the figure below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">FUNstring</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"z^(1/3) * exp(1i * 2*pi/3 * "</span>, <span class="va">k</span>, <span class="st">")"</span><span class="op">)</span>
  <span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="va">FUNstring</span>, 
                xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span>, pi2Div <span class="op">=</span> <span class="fl">12</span>, 
                axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"k = "</span>, <span class="va">k</span><span class="op">)</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
  <span class="co"># emphasize branch cut with a dashed line segment</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> 
  <span class="co"># draw colored arrows</span>
  <span class="va">upperCol</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html">switch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span>,
                     <span class="st">"0"</span> <span class="op">=</span> <span class="st">"black"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>
  <span class="va">lowerCol</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html">switch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span>,
                     <span class="st">"0"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"black"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span><span class="op">)</span>, y0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, y1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>, 
         lwd <span class="op">=</span> <span class="fl">2</span>, length <span class="op">=</span> <span class="fl">0.1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">upperCol</span>, <span class="va">lowerCol</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="viscomplexr-vignette_files/figure-html/figure_10-1.png" alt="Three phase portraits with branch cuts (dashed line), illustrating the three values of $f(z)=z^{1/3}$, $z \in \mathbb{C} \setminus \lbrace 0 \rbrace$. The transitions between the phase portraits are indicated by same-coloured arrows pointing at the branch cuts." width="672"><p class="caption">
Three phase portraits with branch cuts (dashed line), illustrating the three values of <span class="math inline">\(f(z)=z^{1/3}\)</span>, <span class="math inline">\(z \in \mathbb{C} \setminus \lbrace 0 \rbrace\)</span>. The transitions between the phase portraits are indicated by same-coloured arrows pointing at the branch cuts.
</p>
</div>
<p>First, have a look at the leftmost diagram. Note that the argument reference lines have been adjusted to represent angle distances of <span class="math inline">\(30°\)</span>, i.e. <code>pi2Div</code> = 12. Most noticeable is the abrupt color change from yellow to magenta along the negative real axis (emphasized with a dashed line). This is what is called a <em>branch cut</em>, and it suggests that our picture of the function <span class="math inline">\(f(z)=z^{1/3}\)</span> is not complete. As the three third roots of any complex number <span class="math inline">\(z=r\cdot\mathrm{e}^{\mathrm{i}\varphi}, z\in\mathbb{C}\setminus\lbrace0\rbrace\)</span> are <span class="math inline">\(r^{1/3}\cdot\mathrm{e}^{\mathrm{i}\cdot(\varphi+k\cdot2\pi)/3}; k=0,1,2; \varphi\in\left[0,2\pi\right[\)</span>, we require three different phase portraits, one for each <span class="math inline">\(k\)</span>, as shown in the figure above. With the argument reference line distance being <span class="math inline">\(30°\)</span>, it is easy to see that each phase portrait covers a total argument range of <span class="math inline">\(120°\)</span>, i.e. <span class="math inline">\(2\pi/3\)</span>.</p>
<p>Obviously, each of the three portraits has a branch cut along the negative real axis, and the colors at the branch cuts show, where the transitions between the phase portraits have to happen. In the figure, we have illustrated this by arrows pointing to the branch cuts. Same-colored arrows in different phase portraits indicate the transitions. Thus, the first phase portrait (<span class="math inline">\(k = 0\)</span>) links to the second (<span class="math inline">\(k = 1\)</span>) in their yellow zones (black arrows); the second links to the third (<span class="math inline">\(k = 2\)</span>) in their blue zones (red arrows), and the third links back to the first in their magenta zones (green arrows). Actually, one could imagine to stack the three face portraits in ascending order, cut them at the dashed line, and glue the branch cuts together according to the correct transitions. The resulting object is a Riemann surface with each phase portrait being a ‘sheet’. See more about this fascinating concept in <span class="citation">Wegert (2012)</span>, Chapter7.</p>
<p>While the function <span class="math inline">\(f(z)=z^{1/3}\)</span> could be fully covered with three phase portraits, <span class="math inline">\(f(z)=\log z\)</span> has an infinite number of branches. As the (natural) logarithm of any complex number <span class="math inline">\(z=r\cdot\mathrm{e}^{i\cdot\varphi}, r&gt;0\)</span> is <span class="math inline">\(\log z=\log r+\mathrm{i}\cdot\varphi\)</span>, it is evident that the imaginary part of <span class="math inline">\(\log z\)</span> increases linearly with the argument of <span class="math inline">\(z\)</span>, <span class="math inline">\(\varphi\)</span>. In terms of phase portraits, this means an infinite number of stacked ‘sheets’ in either direction, clockwise and counterclockwise. Neighboring sheets connect at a branch cut. We illustrate this below with a phase portrait of <span class="math inline">\(\log z=\log r+\mathrm{i}\cdot(\varphi+k\cdot2\pi), r &gt; 0, \varphi\in\left[0,2\pi\right[\)</span> for <span class="math inline">\(k=-1, 0, 1\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">FUNstring</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"log(Mod(z)) + 1i * (Arg(z) + 2 * pi * "</span>, <span class="va">k</span>, <span class="st">")"</span><span class="op">)</span> 
  <span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="va">FUNstring</span>, pi2Div <span class="op">=</span> <span class="fl">36</span>,
                xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"k = "</span>, <span class="va">k</span><span class="op">)</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="op">}</span>  
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="viscomplexr-vignette_files/figure-html/figure_11-1.png" alt="Three branches of $\log z=\log r+\mathrm{i}\cdot(\varphi + k\cdot2\pi), r&gt;0, \varphi\in\left[0,2\pi\right[$, with $k=-1,0,1$. The branch cuts are marked with dashed white lines." width="672"><p class="caption">
Three branches of <span class="math inline">\(\log z=\log r+\mathrm{i}\cdot(\varphi + k\cdot2\pi), r&gt;0, \varphi\in\left[0,2\pi\right[\)</span>, with <span class="math inline">\(k=-1,0,1\)</span>. The branch cuts are marked with dashed white lines.
</p>
</div>
</div>
<div id="riemann-sphere-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#riemann-sphere-plots" class="anchor"></a>Riemann sphere plots</h3>
<p>A convenient way to visualize the whole complex number plane is based on a stereographic projection suggested by Bernhard Riemann (see <span class="citation">Wegert (2012)</span>, p. 20 ff. and p. 39 ff.). The <em>Riemann Sphere</em> is a sphere with radius 1, centered around the origin of the complex plane. It is cut into an upper (northern) and lower (southern) half by the complex plane. By connecting any point on the complex plane to the north pole with a straight line, the line’s intersection with the sphere’s surface marks the location on the sphere where the point is projected onto. Thus, all points inside the unit disk on the complex plane are projected onto the southern hemisphere, the origin being represented by the south pole. In contrast, all points outside the unit disk are projected onto the northern hemisphere, the north pole representing the <em>point at infinity</em>. For visualizing both hemispheres as 2D phase portraits, they have to be projected onto a flat surface in turn.</p>
<p>If we perform a stereographic projection of the southern hemisphere from the north pole to the complex plane (and look at the plane’s upper - the northern - side), this obviously results in a phase portrait on the untransformed complex plane as were all examples shown so far in this text. We can perform an analogue procedure for the northern hemisphere, projecting it from the south pole to the complex plane. We now want to think of the northern hemisphere projection as layered on top of the southern hemisphere projection, for the northern hemisphere, which it depicts, is naturally also on top of the southern hemisphere. If, in a ‘normal’ visualization of the complex plane (orthogonal real and imaginary axes), a point at any location represents a complex number <span class="math inline">\(z\)</span>, a point at the same location in the northern hemisphere projection is mapped into <span class="math inline">\(1/z\)</span>. The origin is mapped into the point at infinity. Technically, this mapping can be easily achieved when calling the function <code>phasePortrait</code> by setting the flag <code>invertFlip = TRUE</code> (default is <code>FALSE</code>). The resulting map is, in addition, rotated counter-clockwise around the point at infinity by an angle of <span class="math inline">\(\pi\)</span>. As <span class="citation">Wegert (2012)</span> argues, this way of mapping has a convenient visual effect: Consider two phase portraits of the same function, one made with <code>invertFlip = FALSE</code> and the other one with <code>invertFlip = TRUE</code>. Both are shown side by side (see the pairs of phase portraits in the next two figures below). This can be imagined as a view into a Riemann sphere that has been cut open along the equator and swung open along a hinge in the line <span class="math inline">\(\Re(z)=1\)</span> (if the southern hemisphere is at the left side) or <span class="math inline">\(\Re(z)=-1\)</span> (if the northern hemisphere is at the left side). In order to highlight the Riemann sphere in Phase Portraits if desired, we provide the function <code>riemannMask</code>. Let’s first demonstrate this for the function <span class="math inline">\(f(z)=z\)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Southern hemisphere</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"z"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.4</span>, <span class="fl">1.4</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.4</span>, <span class="fl">1.4</span><span class="op">)</span>, 
              pi2Div <span class="op">=</span> <span class="fl">12</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/riemannMask.html">riemannMask</a></span><span class="op">(</span>annotSouth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># Northern hemisphere</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"z"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.4</span>, <span class="fl">1.4</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.4</span>, <span class="fl">1.4</span><span class="op">)</span>, 
              pi2Div <span class="op">=</span> <span class="fl">12</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, invertFlip <span class="op">=</span> <span class="cn">TRUE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/riemannMask.html">riemannMask</a></span><span class="op">(</span>annotNorth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="viscomplexr-vignette_files/figure-html/figure_12-1.png" alt="Mapping the complex number plane on the Riemann sphere. Left: lower (southern) hemisphere; right upper (northern hemisphere). Folding both figures face to face along a vertical line in the middle between them can be imagined as closing the Riemann sphere." width="672"><p class="caption">
Mapping the complex number plane on the Riemann sphere. Left: lower (southern) hemisphere; right upper (northern hemisphere). Folding both figures face to face along a vertical line in the middle between them can be imagined as closing the Riemann sphere.
</p>
</div>
<p>The function <code>riemannMask</code> provides several options, among others adjusting the mask’s transparency or adding annotations to landmark points (see the function’s documentation). In the next example, we will use it without any such features. Consider the following function: <span class="math display">\[
f(z)=\frac{(z^{2}+\frac{1}{\sqrt{2}}+\frac{\mathrm{i}}{\sqrt{2}})\cdot(z+\frac{1}{2}+\frac{\mathrm{i}}{2})}{z-1}
\]</span> This function has two zeroes exactly located on the unit circle, <span class="math inline">\(z_1=\mathrm{e}^{\mathrm{i}\frac{5\pi}{8}}\)</span>, and <span class="math inline">\(z_2=\mathrm{e}^{\mathrm{i}\frac{13\pi}{8}}\)</span>. Moreover, it has another zero inside the unit circle, <span class="math inline">\(z_3=\frac{1}{\sqrt{2}}\cdot\mathrm{e}^{\mathrm{i}\frac{5\pi}{4}}\)</span>. Equally obvious, it has a pole exactly on the unit circle, <span class="math inline">\(z_4=1\)</span>. Less obvious, it has a double pole, <span class="math inline">\(z_5\)</span>, at the point at infinity. The code required for producing the following figure looks somewhat bulky, but most lines are required for annotating the zeroes and poles. Note that the real axis coordinates of the northern hemisphere’s annotation do not have to be multiplied with <span class="math inline">\(-1\)</span> in order to take into account the rotation of the inverted complex plane. By calling <code>phasePortrait</code> with <code>invertFlip = TRUE</code> the coordinate system of the plot is already set up correctly and will remain so for subsequent operations.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">1.4</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Define function</span>
<span class="va">FUNstring</span> <span class="op">&lt;-</span> <span class="st">"(z^2 + 1/sqrt(2) * (1 + 1i)) * (z + 1/2*(1 + 1i)) / (z - 1)"</span>
<span class="co"># Southern hemisphere</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">FUNstring</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span><span class="op">)</span>, 
              pi2Div <span class="op">=</span> <span class="fl">12</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/riemannMask.html">riemannMask</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"Southern Hemisphere"</span>, line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co"># - annotate zeroes and poles</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">8</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="fl">13</span><span class="op">/</span><span class="fl">8</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">4</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,
     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">8</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">13</span><span class="op">/</span><span class="fl">8</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">4</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>, 
     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, 
     pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span>, offset <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>
<span class="co"># Northern hemisphere</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">FUNstring</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span><span class="op">)</span>, 
              pi2Div <span class="op">=</span> <span class="fl">12</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, invertFlip <span class="op">=</span> <span class="cn">TRUE</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/riemannMask.html">riemannMask</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"Northern Hemisphere"</span>, line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co"># - annotate zeroes and poles</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">8</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="fl">13</span><span class="op">/</span><span class="fl">8</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">4</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">8</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">13</span><span class="op">/</span><span class="fl">8</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">4</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, 
     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, 
       <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, 
     pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, offset <span class="op">=</span> <span class="fl">1</span>, 
     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"black"</span>, <span class="st">"white"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="viscomplexr-vignette_files/figure-html/figure_13-1.png" alt="Riemann sphere plot of the function $f(z)=\frac{(z^{2}+\frac{1}{\sqrt{2}}+\frac{\mathrm{i}}{\sqrt{2}})\cdot(z+\frac{1}{2}+\frac{\mathrm{i}}{2})}{z-1}$. Annotated are the zeroes $z_1$, $z_2$, $z_3$, and the poles $z_4$, $z_5$." width="672"><p class="caption">
Riemann sphere plot of the function <span class="math inline">\(f(z)=\frac{(z^{2}+\frac{1}{\sqrt{2}}+\frac{\mathrm{i}}{\sqrt{2}})\cdot(z+\frac{1}{2}+\frac{\mathrm{i}}{2})}{z-1}\)</span>. Annotated are the zeroes <span class="math inline">\(z_1\)</span>, <span class="math inline">\(z_2\)</span>, <span class="math inline">\(z_3\)</span>, and the poles <span class="math inline">\(z_4\)</span>, <span class="math inline">\(z_5\)</span>.
</p>
</div>
<p>With some consideration it becomes quite easy to see that both phase portraits are kind of everted versions of each other. What is inside the unit disk in the left phase portrait is outside in the right one, and vice versa. If you mentally visualize both unit disks touching in, e.g., point <span class="math inline">\(z_4\)</span> and one disk rolling along the edge of the other, you will see immediately how one disk continues the picture shown in the other. Having the ‘Riemann Mask’ somewhat transparent is helpful for orientation (see the function’s documentation). Note, how the zeroes <span class="math inline">\(z_{1, 2}\)</span> and the pole <span class="math inline">\(z_4\)</span> which are located exactly on the unit circle continue outside the unit disk on ‘their own’ plane and in the other unit disk. Note also, that on both hemispheres zeroes and poles can be identified by the same sequence of colors: When circling counter-clockwise around the point of interest, a zero will always exhibit the color sequence red, yellow, green, blue, magenta, red …, while this order will always be reverted for a pole. As the pole at the point at infinity (<span class="math inline">\(z_5\)</span>) is a double pole, the color sequence is run through twice during one turn around the pole. As the zero <span class="math inline">\(z_3\)</span> is inside the unit disk representing the southern hemisphere, it lies outside the northern hemisphere disk, but it is still visible on the continuation of the inverted (and rotated) complex plane (belonging to the northern hemisphere) outside the unit disk. Observe, how the grid lines in the vicinity of <span class="math inline">\(z_3\)</span> merge when passing from one unit disk to the other.</p>
</div>
<div id="fractals" class="section level3">
<h3 class="hasAnchor">
<a href="#fractals" class="anchor"></a>Fractals</h3>
<p>While visualizing fractals is not among the original purposes of this package, <em>phasePortrait</em> allows for an unusual way of displaying such that are functions of complex numbers. Classic examples are the <a href="https://en.wikipedia.org/wiki/Mandelbrot_set">Mandelbrot set</a> and the <a href="https://en.wikipedia.org/wiki/Julia_set">Julia set</a>, and this package provides the functions <code>mandelbrot</code> and <code>juliaNormal</code> (implemented in C++) for supporting visualization. The mandelbrot set comprises all complex numbers <span class="math inline">\(z\)</span> for which the sequence <span class="math inline">\(a_{n+1}=a_n^{2}+z\)</span> with <span class="math inline">\(a_0=0\)</span> remains bounded for all <span class="math inline">\(n\in\mathbb{N_0}\)</span>. Normal julia sets are closely related to the Mandelbrot set. They comprise all complex numbers <span class="math inline">\(z\)</span> for which the sequence <span class="math inline">\(a_{n+1}=a_n^2+c\)</span> with <span class="math inline">\(a_0=z\)</span> remains bounded for all <span class="math inline">\(n\in\mathbb{N_0}\)</span>. The parameter <span class="math inline">\(c\)</span> is a complex number, and interesting visualizations with this package (i.e. other than a blank screen) are only obtained for <span class="math inline">\(c\)</span> being an element of the Mandelbrot set. For the author’s taste, the Julia set visualizations look best and are most interesting when <span class="math inline">\(c\)</span> is located near the border of the Mandelbrot set. The classic visualizations of the Mandelbrot and the Julia set use a uniform color (usually black) for all points which belong to the set and color the points outside the set dependent on how quickly they diverge. Visualizations with <em>phasePortrait</em>, in contrast, color the points inside the sets by the argument and modulus of the number to which the series described above converges (or, more precisely, at which the iteration terminates). While the results are visually appealing (please try the code examples we provide below), they are not unambiguous, as the sequences that define the sets do not always converge to one single value, but to limit cycles.</p>
<p>The following code plots an overview picture of the Mandelbrot set. Note that the function <code>mandelbrot</code> is called with a considerably low value (30) for the parameter <code>itDepth</code> which defines the number of iterations to be calculated (default is 500). This is because we are using <em>phasePortrait</em> for plotting into a graphics window with a comparatively low resolution (see section <a href="#img_qual">defining image quality</a> for how to obtain high-quality phase portraits). While a high number of iterations produces a more accurate representation of the set, the resulting filigree structures might become hardly visible or even invisible when the resolution to be plotted on is low.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/x11.html">x11</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span> <span class="op">*</span> <span class="fl">8</span><span class="op">)</span>      <span class="co"># Open graphics window on screen</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>        <span class="co"># Do not leave plot margins</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">mandelbrot</span>, moreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>itDepth <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,
              ncores <span class="op">=</span> <span class="fl">1</span>,             <span class="co"># Increase or leave out for higher performance</span>
              xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,
              hsvNaN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,    <span class="co"># black color for points outside the set </span>
              axes <span class="op">=</span> <span class="cn">FALSE</span>,           <span class="co"># No coordinate axes   </span>
              xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span><span class="op">)</span> <span class="co"># No space between plot region and plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>                               <span class="co"># Set graphics parameters to original</span></code></pre></div>
<p>With the code example below we plot a cutout of the Mandelbrot set into a png file with a resolution of 600 dpi using the default number of iterations (500). We are using a few features that are just commented here, but will be explained below in the section <a href="#hints_artistic">aesthetic hints</a>. Other graphics file formats can be used in almost the same way. Type <code><a href="https://rdrr.io/r/grDevices/png.html">?png</a></code> in order to see all formats and how to call them. See also section <a href="#img_qual">defining image quality</a>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span>  <span class="op">&lt;-</span> <span class="fl">600</span> <span class="co"># set resolution to 600 dpi</span>
<span class="co"># open png graphics device with in DIN A4 format</span>
<span class="co"># DIN A format has an edge length ratio of sqrt(2)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="st">"Mandelbrot Example.png"</span>, 
    width <span class="op">=</span> <span class="fl">29.7</span>, height <span class="op">=</span> <span class="fl">29.7</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="co"># DIN A4 landscape</span>
    units <span class="op">=</span> <span class="st">"cm"</span>, 
    res <span class="op">=</span> <span class="va">res</span><span class="op">)</span>                   <span class="co"># resolution is required</span>
<span class="va">op</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="co"># set graphics parameters - no plot margins</span>
<span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.254</span>, <span class="op">-</span><span class="fl">1.248</span><span class="op">)</span>        <span class="co"># horizontal (real) plot limits  </span>
<span class="co"># the function below adjusts the imaginary plot limits to the</span>
<span class="co">#   desired ratio (sqrt(2)) centered around the desired imaginary value</span>
<span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ylimFromXlim.html">ylimFromXlim</a></span><span class="op">(</span><span class="va">xlim</span>, centerY <span class="op">=</span> <span class="fl">0.02</span>, x_to_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">mandelbrot</span>,
              nCores <span class="op">=</span> <span class="fl">1</span>,             <span class="co"># Increase or leave out for higher performance</span>
              xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span>,
              hsvNaN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,    <span class="co"># Black color for NaN results</span>
              xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>, <span class="co"># suppress R's default axis margins</span>
              axes <span class="op">=</span> <span class="cn">FALSE</span>,           <span class="co"># do not plot axes</span>
              res <span class="op">=</span> <span class="va">res</span><span class="op">)</span>              <span class="co"># resolution is required</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>   <span class="co"># reset graphics parameters</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># close graphics device and complete the png file</span></code></pre></div>
<p>Inside the same technical setting, the following two examples plot Julia sets into a png file.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fl">600</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="st">"Julia Example 1.png"</span>, width <span class="op">=</span> <span class="fl">29.7</span>, height <span class="op">=</span> <span class="fl">29.7</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,
    units <span class="op">=</span> <span class="st">"cm"</span>, res <span class="op">=</span> <span class="va">res</span><span class="op">)</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.8</span>, <span class="fl">1.8</span><span class="op">)</span>
<span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ylimFromXlim.html">ylimFromXlim</a></span><span class="op">(</span><span class="va">xlim</span>, centerY <span class="op">=</span> <span class="fl">0</span>, x_to_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">juliaNormal</span>,
              <span class="co"># see documentation of juliaNormal about the arguments</span>
              <span class="co">#  c and R_esc</span>
              moreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>c <span class="op">=</span> <span class="op">-</span><span class="fl">0.09</span> <span class="op">-</span> <span class="fl">0.649i</span>, R_esc <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
              nCores <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Increase or leave out for higher performance</span>
              xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span>,
              hsvNaN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
              xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>,
              axes <span class="op">=</span> <span class="cn">FALSE</span>,
              res <span class="op">=</span> <span class="va">res</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fl">600</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="st">"Julia Example 2.png"</span>, width <span class="op">=</span> <span class="fl">29.7</span>, height <span class="op">=</span> <span class="fl">29.7</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,
    units <span class="op">=</span> <span class="st">"cm"</span>, res <span class="op">=</span> <span class="va">res</span><span class="op">)</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.32</span>, <span class="fl">0.02</span><span class="op">)</span>
<span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ylimFromXlim.html">ylimFromXlim</a></span><span class="op">(</span><span class="va">xlim</span>, center <span class="op">=</span> <span class="op">-</span><span class="fl">0.78</span>, x_to_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">juliaNormal</span>, 
              <span class="co"># see documentation of juliaNormal about the arguments</span>
              <span class="co">#  c and R_esc</span>
              moreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>c <span class="op">=</span> <span class="op">-</span><span class="fl">0.119</span> <span class="op">-</span> <span class="fl">0.882i</span>, R_esc <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
              nCores <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Increase or leave out for higher performance</span>
              xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span>,
              hsvNaN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
              xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>,
              axes <span class="op">=</span> <span class="cn">FALSE</span>,
              res <span class="op">=</span> <span class="va">res</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="hints_artistic" class="section level2">
<h2 class="hasAnchor">
<a href="#hints_artistic" class="anchor"></a>Aesthetic hints</h2>
<p>While phase portraits were originally invented for scientific and technical purposes, their aesthetic quality is a feature in itself. In this section, we give a few technical hints that might be helpful for obtaining appealing graphics. We will be not only talking about features implemented in this package, but also mention some useful options provided by R base graphics. A general recommendation when plotting for maximum aesthetic results is also to first check out the function to be plotted with lower resolutions (e.g. the default 150 dpi), and a smaller format (but with the desired device aspect ratio), adjust the domain (<code>xlim</code>, <code>ylim</code>), and all other parameters of <em>phasePortrait</em> you might want to change (including the parameters <code>gamma</code> and <code>stdSaturation</code> we have not mentioned in this vignette, so far). Only if you are satisfied with the result at that stage, you should start the run with the desired final resolution and format, as plots at high resolution and large formats may be time-consuming depending on your hardware (see also the section <a href="#img_qual">defining image quality</a>). When using the function <code>riemannMask</code> you could try changing the mask’s transparency (<code>alphaMask</code>) and it’s color (<code>colMask</code>). Often, black is a good alternative to the default white). Besides such simple issues there are, however, a few points we will talk about in more detail below.</p>
<div id="the-parop-mechanism" class="section level3">
<h3 class="hasAnchor">
<a href="#the-parop-mechanism" class="anchor"></a>The <code>par(op)</code> mechanism</h3>
<p>As mentioned above, <em>phasePortrait</em> uses <strong>R</strong>’s base graphic system. This is a powerful tool, its functionality is, however, not always easy to understand and use. Many fundamental settings of base <strong>R</strong> graphics are stored in a set of parameters, which can be set or queried using the function <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>. Among the important graphical parameters in our context are those which steer the outer margins and the plot margins (<code>oma</code>, <code>omi</code>, <code>mar</code>, <code>mai</code>) and those which define the default background and foreground colors (<code>bg</code>, <code>fg</code>). Type <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code> to see a documentation of all parameters. Changing these parameters here and there during an <strong>R</strong> session can easily lead to graphical results that may be nice but hard to reproduce. For avoiding this, when <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> is called to change one or more graphical parameters, it invisibly returns all parameters and their values <em>before</em> the change. These can be stored in a variable, and used to restore the original parameter values after the plotting has been done. This concept seems to be unknown to surprisingly many users of <strong>R</strong>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set the plot margins at all four sides to 1/5 inch with mai,</span>
<span class="co"># set the background color to black with bg, and the default foreground</span>
<span class="co"># color with fg (e.g. for axes and boxes around plots, or the color of</span>
<span class="co"># the circle outline from the function riemannMask).</span>
<span class="co"># We catch the previous parameter values in a variable, I called</span>
<span class="co"># "op" ("old parameters")</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>, bg <span class="op">=</span> <span class="st">"black"</span>, fg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>

<span class="co"># Make any phase portraits and/or other graphics of your interest</span>
<span class="co"># ...</span>

<span class="co"># Set the graphical parameters back to the values previously stored in op</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
</div>
<div id="dealing-with-axes" class="section level3">
<h3 class="hasAnchor">
<a href="#dealing-with-axes" class="anchor"></a>Dealing with axes</h3>
<p>Usually, when aiming for mainly aesthetic effects, you want to suppress plot axes from being drawn. As phase <em>phasePortrait</em> accepts, via its <code>...</code> argument, all arguments also accepted by <strong>R</strong>’s <code>plot.default</code>, this can be easily achieved by providing the argument <code>axes = FALSE</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"tan(z^3 + 1/2 - 2i)/(1 - 1i - z)"</span>, 
              xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,
              axes <span class="op">=</span> <span class="cn">FALSE</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance</span></code></pre></div>
<p>Note that this does not only suppress both axes, but also the box usually drawn around a plot. If such a box is desired, it can be simply added afterwards by calling <code><a href="https://rdrr.io/r/graphics/box.html">box()</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"tan(z^3 + 1/2 - 2i)/(1 - 1i - z)"</span>, 
              xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,
              axes <span class="op">=</span> <span class="cn">FALSE</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>If axes are desired together with a special aesthetic appeal (e.g. for presentations), it is worth trying out a black background and white axes. However, there are unexpected hurdles to take, before the result looks as it should:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set background and foreground colors</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>bg <span class="op">=</span> <span class="st">"black"</span>, fg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>
<span class="co"># Setting the parameter fg has an effect on the box, the axes, and the axes' </span>
<span class="co"># ticks, but not on the axis annotations and axis labels.</span>
<span class="co"># Also the color of the title (main) is not affected. </span>
<span class="co"># The colors of these elements have to be set manually and separately. While we</span>
<span class="co"># could simply set them to "white", we set them, more flexibly, to the </span>
<span class="co"># current foreground color (par("fg")).</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"tan(z^3 + 1/2 - 2i)/(2 - 1i - z)"</span>,
              xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,            col.axis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"fg"</span><span class="op">)</span>,
              xlab <span class="op">=</span> <span class="st">"real"</span>, ylab <span class="op">=</span> <span class="st">"imaginary"</span>,           col.lab  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"fg"</span><span class="op">)</span>,
              main <span class="op">=</span> <span class="st">"All annotation in foreground color"</span>, col.main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"fg"</span><span class="op">)</span>,
              <span class="co"># Adjust text size</span>
              cex.axis <span class="op">=</span> <span class="fl">0.9</span>, cex.lab <span class="op">=</span> <span class="fl">0.9</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<p>Note that by default the axes are constructed with an overhang of 4% beyond the ranges given with <code>xlim</code> and <code>ylim</code> at each end. More often than not this looks nice, but sometimes it is undesired, e.g. when a phase portrait is intended to cover the full display without any frame and margin. This behavior is due to the graphical parameters <code>xaxs</code> and <code>yaxs</code> (axis style) being set to ‘r’ (‘regular’) by default. Setting these parameters as <code>xaxs = "i"</code> and <code>yaxs = "i"</code> (‘internal’), no overhang is added. Both, <code>xaxs</code> and <code>yaxs</code>, can be either set in a call to <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> or handed as arguments to <em>phasePortrait</em>. We will come back to these parameters in the following section.</p>
</div>
<div id="device-ratio-and-margins" class="section level3">
<h3 class="hasAnchor">
<a href="#device-ratio-and-margins" class="anchor"></a>Device ratio and margins</h3>
<p>You might want to plot a phase portrait that fully covers the graphics device. The following code example shows how to achieve this. First, it is necessary to set the plot margins to zero (note that the outer margins are zero by default, so, usually, there is no need to care for them). Second, as <em>phasePortrait</em> uses an aspect ratio of 1 by default, <code>xlim</code> and <code>ylim</code> have to exactly match the aspect ratio of the graphics device to be plotted in. In order to facilitate this, we provide the functions <code>ylimFromXlim</code> and <code>xlimFromYlim</code>. In the example, we use the former in order to match <code>xlim</code> and <code>ylim</code> a device aspect ratio of 16/9. Third, in order to omit the 4% axis overhang (would look like a margin), the parameters <code>xaxs</code> and <code>yaxs</code> are set to “i”. Setting <code>axes</code> to FALSE is not absolutely necessary in this case, but is good style.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Open graphics device with 16/9 aspect ratio and 7 inch width</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/x11.html">x11</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">9</span><span class="op">/</span><span class="fl">16</span> <span class="op">*</span> <span class="fl">7</span><span class="op">)</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="co"># Set plot margins to zero</span>
<span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co"># Calculate ylim with desired center fitting the desired aspect ratio</span>
<span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ylimFromXlim.html">ylimFromXlim</a></span><span class="op">(</span><span class="va">xlim</span>, centerY <span class="op">=</span> <span class="fl">0</span>, x_to_y <span class="op">=</span> <span class="fl">16</span><span class="op">/</span><span class="fl">9</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">jacobiTheta</span>, moreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">1i</span><span class="op">/</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>, pType <span class="op">=</span> <span class="st">"p"</span>, 
              xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span>,
              xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>,
              axes <span class="op">=</span> <span class="cn">FALSE</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<p>Not many changes are necessary for obtaining a phase portrait like above but with a frame. A convenient way to do this is to set the outer margins of the graphics device in inches with the graphical parameter <code>omi</code> and the background to the desired color. Adding this to the code above, however, leads to differing horizontal and vertical frame widths. This occurs because, due to the margin setting, the required ratio of the <code>xlim</code> and <code>ylim</code> ranges is no longer exactly 16/9. The precise ratio has to be calculated and provided to <code>ylimFromXlim</code> as shown in the code example below.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Open graphics device with 16/9 aspect ratio and a width of 7 inches </span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/x11.html">x11</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">9</span><span class="op">/</span><span class="fl">16</span> <span class="op">*</span> <span class="fl">7</span><span class="op">)</span>
<span class="co"># Set plot margins to zero, outer margins to 1/7 inch,</span>
<span class="co">#   and background color to black</span>
<span class="va">outerMar</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">7</span> <span class="co"># outer margin width in inches</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, omi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">outerMar</span>, <span class="fl">4</span><span class="op">)</span>, bg <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> 
<span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="co"># Calculate ylim with desired center fitting the desired aspect ratio;</span>
<span class="co">#   however, the omi settings slightly change the required </span>
<span class="co">#   ratio of xlim and ylim</span>
<span class="va">ratio</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">outerMar</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">7</span> <span class="op">*</span> <span class="fl">9</span><span class="op">/</span><span class="fl">16</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">outerMar</span><span class="op">)</span>
<span class="va">ylim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ylimFromXlim.html">ylimFromXlim</a></span><span class="op">(</span><span class="va">xlim</span>, centerY <span class="op">=</span> <span class="fl">0</span>, x_to_y <span class="op">=</span> <span class="va">ratio</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"sin(jacobiTheta(z, tau))/z"</span>, moreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">1i</span><span class="op">/</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>,
              pType <span class="op">=</span> <span class="st">"p"</span>,
              xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span>,
              xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>,
              axes <span class="op">=</span> <span class="cn">FALSE</span>,
              nCores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="tech_moreabouts" class="section level2">
<h2 class="hasAnchor">
<a href="#tech_moreabouts" class="anchor"></a>Technical moreabouts</h2>
<p>This chapter details a few technical points which might be of interest for optimizing the results obtained by using the <strong>R</strong> package at hand. We talk about different ways to <a href="#ways_functions">provide functions</a> to <em>phasePortrait</em>, and about how to control <a href="#img_qual">image quality</a>. And there is more: The function <em>phasePortrait</em> has to perform several memory and time critical operations. In order to keep memory utilization on a reasonable level and to optimize computing times, the function works with <a href="#tempfiles">temporary files</a> and <a href="#par_proc">parallel processing</a>. We explain both below, because the user can influence their behavior. For avoiding unnecessary copying of big arrays, <em>phasePortrait</em> makes also use of pointers, but as there is no related control option for the user, we reserve this for a later version of this vignette.</p>
<div id="ways_functions" class="section level3">
<h3 class="hasAnchor">
<a href="#ways_functions" class="anchor"></a>Ways to provide functions to <em>phasePortrait</em>
</h3>
<div id="quoted-character-strings" class="section level4">
<h4 class="hasAnchor">
<a href="#quoted-character-strings" class="anchor"></a>Quoted character strings</h4>
<p>Any function to be visualized with <em>phasePortrait</em> must be provided as the argument <code>FUN</code>. In some cases (see below), the argument <code>moreArgs</code> can turn out useful in combination with <code>FUN</code>. Probably the easiest way of defining <code>FUN</code> is a character string which is an expression <strong>R</strong> can evaluate as a function of a complex number <span class="math inline">\(z\)</span>. See some examples:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Note that 'FUN =' is not required if the argument to FUN is handed to </span>
<span class="co"># phasePortrait in the first position</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="st">"1/(1 - z^2)"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"sin((z - 2)/(z + 2))"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"tan(z)"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>If your expression requires arguments besides <span class="math inline">\(z\)</span> you can provide them to <em>phasePortrait</em> by means of <code>moreArgs</code>, which expects a named list containing the additional arguments:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"-1 * sum(z^c(-k:k))"</span>, moreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,
              xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span>,
              pType <span class="op">=</span> <span class="st">"p"</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance </span></code></pre></div>
<p>While we recommend other solutions (see below), it is also possible to hand over more extensive user-defined functions as character strings. To make this work, however, the function must be wrapped in a <code>vapply</code> construct which guarantees the output of the function being a complex number by setting vapply’s argument <code>FUN.VALUE</code> as <code><a href="https://rdrr.io/r/base/complex.html">complex(1)</a></code>. Moreover, the first argument to <code>vapply</code> must be <span class="math inline">\(z\)</span>. In such cases, it is often convenient to define the character string outside the call to <em>phasePortrait</em> and hand it over after that, as we do in the following example:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">funString</span> <span class="op">&lt;-</span> <span class="st">"vapply(z, FUN = function(z) {
                  n &lt;- 9
                  k &lt;- z^(c(1:n))
                  rslt &lt;- sum(sin(k))
                  return(rslt)
                },
                FUN.VALUE = complex(1))"</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">funString</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, 
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance</span></code></pre></div>
<p>If such a function has arguments in addition to <span class="math inline">\(z\)</span>, they can be included into the call to ‘vapply’ and thus included into the string (for supporting this, we provide the function <code>vector2string</code>, see the example in its documentation), but we do not recommend that. Anyway, if you must know, here it is:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">funString</span> <span class="op">&lt;-</span> <span class="st">"vapply(z, FUN = function(z, fct) {
                  n &lt;- 9
                  k &lt;- z^(fct * c(1:n))
                  rslt &lt;- sum(sin(k))
                  return(rslt)
                },
                fct = -1, 
                FUN.VALUE = complex(1))"</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">funString</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance</span></code></pre></div>
<p>Probably, the most useful application of this concept is when the <code>vapply</code> construct is pasted together at runtime with values for the additional arguments depending on what happened earlier. However, defining the function directly as a function first, and then simply passing its name to <em>phasePortrait</em> leads to a more readable code:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define function</span>
<span class="va">tryThisOne</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">fct</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">z</span><span class="op">^</span><span class="op">(</span><span class="va">fct</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>
  <span class="va">rslt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">rslt</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Call function by its name only, provide additional arguments via "moreArgs"</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"tryThisOne"</span>, moreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fct <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
  nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance</span></code></pre></div>
<p>As the function in the example above requires two additional arguments beside <span class="math inline">\(z\)</span>, we hand them over to <em>phasePortrait</em> via the argument <code>moreArgs</code>, which must be (even in case of only one additional argument) a named list (names must match the names of the required arguments), where the argument values are assigned.</p>
</div>
<div id="function-objects" class="section level4">
<h4 class="hasAnchor">
<a href="#function-objects" class="anchor"></a>Function objects</h4>
<p>Besides character strings as shown above, the argument <code>FUN</code> can also directly take function objects. The simplest case is an anonymous function definition:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use argument "hsvNaN = c(0, 0, 0)" if you want the grey area black</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">{</span> 
    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">z</span> <span class="op">&lt;-</span> <span class="va">z</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2i</span>
    <span class="op">}</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>
  <span class="op">}</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
  nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance </span></code></pre></div>
<p>Evidently, this can be used with <code>moreArgs</code> as well:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use argument "hsvNaN = c(0, 0, 0)" if you want the grey area black</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span> 
    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">z</span> <span class="op">&lt;-</span> <span class="va">z</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>
  <span class="op">}</span>,
  moreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">27</span><span class="op">)</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
  nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance </span></code></pre></div>
<p>Any function object that is known by name to R, be it user-defined or contained in a package will work in the same way. Just hand over the function object itself:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># atan from package base</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">atan</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">)</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="co"># gammaz from package pracma (the package must be installed on your machine</span>
<span class="co"># if you want this example to be working)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="fu">pracma</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/pracma/man/gammaz.html">gammaz</a></span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">9</span>, <span class="fl">9</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="co"># blaschkeProd from this package (moreArgs example)</span>
<span class="co">#  make random vector of zeroes</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">12</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html">complex</a></span><span class="op">(</span>modulus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, argument <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>
<span class="co">#  plot the actual phase portrait</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">blaschkeProd</span>, moreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span><span class="op">)</span>, 
              xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span><span class="op">)</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="co"># User function example</span>
<span class="va">tryThisOneToo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">n</span>, <span class="va">r</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">z</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">*</span> <span class="op">(</span><span class="va">z</span> <span class="op">+</span> <span class="va">z</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="op">}</span> 
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>
<span class="op">}</span> 
<span class="co"># Use argument "hsvNaN = c(0, 0, 0)" if you want the gray areas black</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="va">tryThisOneToo</span>, moreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, r <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2i</span><span class="op">)</span>,
              xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>Defining own functions in C++ and using them with <em>phasePortrait</em> usually gives a substantial performance gain. This is especially true if they require operations that cannot be vectorized in <strong>R</strong> (i.e. if there is now way to avoid for-loops or similar). The ideal tool for integrating C++ code in <strong>R</strong> programs is <em>Rcpp</em> <span class="citation">(Eddelbuettel and Balamuta 2017)</span>, but be aware that C++ functions compiled with <code><a href="https://rdrr.io/pkg/Rcpp/man/sourceCpp.html">Rcpp::sourceCpp</a></code> will not work with <em>phasePortrait</em>, as this is not compatible with parallel processing. What it takes is to provide the C++ functions as or as part of an R package which is not difficult at all. The functions of the <code>math</code> family included in this package have all been coded in C++ and integrated with <em>Rcpp</em>.</p>
</div>
</div>
<div id="img_qual" class="section level3">
<h3 class="hasAnchor">
<a href="#img_qual" class="anchor"></a>Defining image quality</h3>
<p>Clearly, there is a trade-off between the quality of an image plotted with <em>phasePortrait</em> and the computing time. The image quality is defined by the argument <code>res</code> and has a default value of 150 dpi. For pictures in standard sizes of about 30 x 20 cm plotting with 150 dpi does not take much time, and for many purposes, this resolution is sufficient. When resolutions of 300, 600 or more dpi are desired for high-quality printouts, we recommend to try out everything with 150 dpi (and, maybe, on a small format) before starting the final high-quality run. Technically, early after being called, <em>phasePortrait</em> gets the plot region size of the active graphics device and calculates the number of required pixels from this size and the value of <code>res</code>. Note, that <strong>R</strong> graphics devices for files, like <code>png</code>, <code>bmp</code>, <code>jpeg</code> and <code>tiff</code>, also expect a parameter <code>res</code> (if the units given for device height and width are cm or inches). For plotting to graphics files, we suggest to store the desired resolution in a variable first, and pass it to both, the graphics device and <em>phasePortrait</em>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fl">300</span> <span class="co"># Define desired resolution in dpi</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="st">"Logistic_Function.png"</span>, width <span class="op">=</span> <span class="fl">40</span>, height <span class="op">=</span> <span class="fl">40</span> <span class="op">*</span> <span class="fl">3</span><span class="op">/</span><span class="fl">4</span>, 
    units <span class="op">=</span> <span class="st">"cm"</span>, res <span class="op">=</span> <span class="va">res</span><span class="op">)</span>
<span class="fu"><a href="../reference/phasePortrait.html">phasePortrait</a></span><span class="op">(</span><span class="st">"1/(1+exp(-z))"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">15</span><span class="op">)</span>, res <span class="op">=</span> <span class="va">res</span>,
              xlab <span class="op">=</span> <span class="st">"real"</span>, ylab <span class="op">=</span> <span class="st">"imaginary"</span>,
              nCores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Increase or leave out for higher performance</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="tempfiles" class="section level3">
<h3 class="hasAnchor">
<a href="#tempfiles" class="anchor"></a>Temporary files</h3>
<p>In order to keep the machine’s RAM workload manageable, <em>phasePortrait</em> will always save data in temporary files. These files are stored in the directory specified with the argument <code>tempDir</code> (default is the current <strong>R</strong> session’s temporary directory). After normal execution, these files will be automatically deleted, so, usually, there is no need to care about. Automatic deletion, however, will not happen, if the user calls <em>phasePortrait</em> with the parameter <code>deleteTempFiles</code> set to FALSE or if phasePortrait does not terminate properly. Thus, if <em>phasePortrait</em> crashed you should check the directory specified as <code>tempDir</code> and delete these files, because they usually are of considerable size. However, such orphans will never interfere with further runs of <em>phasePortrait</em> (see below).</p>
<p>The size of these temporary files depends from <em>phasePortrait</em>’s parameter <code>blockSizePx</code> (default: 2250000; it may be worth varying this value in order to obtain optimum performance on your machine). If the two-dimensional array of pixels to be plotted comprises more pixels than specified by this parameter, the array will be vertically split into blocks of that size. These sub-arrays are what is stored in the temporary files. More precisely, there are two temporary files per sub-array. One represents the cutout of the untransformed complex plane over which the function of interest is applied; the other contains the values obtained by applying the function to the first one. Thus, each array cell contains a double precision complex number; in a temporary file pair an array cell at the same position refers to the same pixel in the plot.</p>
<p>These files are <code>.RData</code> files, and their names adhere to a strict convention, see the following examples:</p>
<p><code>0001zmat2238046385.RData</code></p>
<p><code>0001wmat2238046385.RData</code></p>
<p>These are examples of names of a pair of temporary files belonging to the same block (sub-array). The names are equal except for one substring which can either be ‘zmat’ or ‘wmat’. The former file contains an untransformed cutout of the complex plane, and the latter the corresponding values obtained from the function of interest as explained above.</p>
<p>Both names begin with ‘0001’, indicating that the array’s top line is the first line of the <em>whole</em> pixel array to be covered by the phasePortrait. The name of the file that contains the subsequent array can e.g. begin with a number like ‘0470’, indicating that its first line is line number 470 of the whole array. The number of digits for these line numbers is not fixed. It is determined by the greatest number required. Numbers with less digits are zero-padded. The second part of the file name is either zmat or wmat (see above). The third part of the file names is a ten-digit integer. This is a random number which all temporary files stemming from the same call of <em>phasePortrait</em> have in common. This guarantees that no temporary files will be confounded in subsequent calls of <em>phasePortrait</em>, even if undeleted temporary files from previous runs are still present.</p>
</div>
<div id="par_proc" class="section level3">
<h3 class="hasAnchor">
<a href="#par_proc" class="anchor"></a>Parallel processing</h3>
<p>For enhanced performance, <em>phasePortrait</em> uses parallel processing as provided via the <strong>R</strong> packages <code>doParallel</code> <span class="citation">(Microsoft and Weston 2019)</span> and <code>foreach</code> <span class="citation">(Microsoft and Weston 2020)</span>. The number of processor cores to be used can be set with the parameter <code>nCores</code> when calling <em>phasePortrait</em>. By default, all present cores will be utilized. Clearly, setting <code>nCores = 1</code> will result in sequential processing. When <em>phasePortrait</em> is called with <code>ncores &gt; 1</code>, and no parallel backend is registered, one will be registered first. The same applies, when a parallel backend is already registered, but the user desires a different number of cores. This registering may take some time. Therefore, when it terminates, <em>phasePortrait</em> does not automatically de-register the parallel backend (and register a sequential backend again). This saves registering time in subsequent runs of <em>phasePortrait</em> with the same number of cores to be used. This default behavior - keeping parallel backends registered after termination - can be changed by setting the parameter <code>autoDereg</code> on TRUE (default is FALSE). Otherwise, <em>phasePortrait</em>, after completing the plot, prints a message that the current parallel backend can be manually de-registered with the command <code><a href="https://rdrr.io/pkg/foreach/man/registerDoSEQ.html">foreach::registerDoSEQ()</a></code>. We recommend to do this after the last call to <em>phasePortrait</em> in an <strong>R</strong> session.</p>
<p>There are three occasions, when <em>phasePortrait</em> utilizes parallel processing: First, after determining the size and number range (in the complex plane) of the whole two dimensional array of pixels to be plotted, the sub-arrays (blocks) corresponding to the parameter value <code>blockSizePx</code> are constructed and saved as temporary files in a parallel loop. These are the temporary files with the string <code>zmat</code> in their names (see section <a href="#tempfiles">Temporary files</a>). Second, while the single blocks are loaded and processed sequentially, each block is evaluated in a separate parallel process. In order to do so, the block is split into a few approximately equally sized parts; the number of these parts corresponds to the number of processor cores to be used. In each parallel process the function to be plotted is applied to each single cell of the corresponding block part (internally vectorized with <code>vapply</code>). The outcomes of all parallel processes are combined into one array which is saved as a temporary file which has the string <code>wmat</code> in its name. Third, for transforming the function values stored in the <code>wmat</code> files into <a href="https://en.wikipedia.org/wiki/HSL_and_HSV">hsv colors</a>, a similar concept as in the second step is utilized: The single <code>wmat</code> files are processed sequentially, but the array stored in each file is split into chunks which are dealt with parallely. Eventually, transforming all <code>wmat</code> arrays results in one large color value array which can be plotted after that. Handling this large array is the most memory-intensive task when running <em>phasePortrait</em>, and it can take considerable time for large plots in high quality. So far, however, no alternative solution provided fully satisfying results.</p>
<p>As mentioned in the section about <a href="#tempfiles">temporary files</a>, users can possibly optimize performance by trying different values for the parameter <code>blockSizePx</code>. We mention this here as well, as <code>blockSizePx</code> does not only influence size and number of the temporary files, but also the size of the array chunks that are processed parallely.</p>
<p>Obviously, applying the function of interest to millions of values is time-critical. Therefore, when defining a function for a phase portrait in <strong>R</strong>, use all options at hand for vectorizing calculations. Moreover, you can count on a significant performance gain when you write time critical functions in C++. Thanks to the package <em>Rcpp</em> <span class="citation">(Eddelbuettel and Balamuta 2017)</span> this not really a hurdle anymore. As mentioned above, however, C++ functions compiled with <code><a href="https://rdrr.io/pkg/Rcpp/man/sourceCpp.html">Rcpp::sourceCpp</a></code> will not work with <em>phasePortrait</em>, as this is not compatible with parallel processing; you have to provide such functions in a package. The package at hand provides a few functions (function family <code>maths</code>); all of them have been implemented in C++.</p>
</div>
</div>
<div id="acknowledgments" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgments" class="anchor"></a>Acknowledgments</h2>
<p>While this package is a leisure project, it would have been a mission impossible without the background of my daily work with R as a Forest Scientist at the Technical University of Munich (TUM). Fortunately, I have a job that allows me to learn about Nature by asking her questions (or trying to simulate what she is doing) with ever-improving methods and tools. I would like to thank everyone at the Chair of Forest Growth and Yield Science at TUM who keep me involved in discussions like: <em>How can this be solved in R …</em></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/switch.html">switch</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">trunc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>,
       <span class="st">"... at all?"</span>,
       <span class="st">"... in a quick-and-dirty way?"</span>,
       <span class="st">"... in Hadley-Wickham-style?"</span>,
       <span class="st">"... without a loop?"</span>,
       <span class="st">"... without nested loops?"</span>,
       <span class="st">"... in a way somebody can understand?"</span><span class="op">)</span></code></pre></div>
<p><strong>Veronika Biber</strong> provided expert advice for improving the vignette. <strong>Johannes Biber</strong> turned out the most patient pre-release tester one can imagine, boosting things with his high-end gaming machine. Thanks, guys! Also thanks to <strong>Gregor Seyer</strong> for his helpful review of the CRAN submission.</p>
<p>Clearly, programming in R would not be what it is, weren’t there some R titans who generously share their knowledge online. While I keep learning from all of them, I would like to thank especially <strong>Hadley Wickham</strong> and <strong>Dirk Eddelbüttel</strong>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-edelbuettel_rcpp_2017">
<p>Eddelbuettel, Dirk, and James Joseph Balamuta. 2017. “Extending R with C++: A Brief Introduction to Rcpp.” <em>PeerJ Preprints</em> 5 (August): e3188v1. <a href="https://doi.org/10.7287/peerj.preprints.3188v1">https://doi.org/10.7287/peerj.preprints.3188v1</a>.</p>
</div>
<div id="ref-micwest_doparallel_2019">
<p>Microsoft, and Steve Weston. 2019. <em>DoParallel: Foreach Parallel Adaptor for the ’Parallel’ Package</em>. <a href="https://CRAN.R-project.org/package=doParallel">https://CRAN.R-project.org/package=doParallel</a>.</p>
</div>
<div id="ref-micwest_foreach_2020">
<p>———. 2020. <em>Foreach: Provides Foreach Looping Construct</em>. <a href="https://CRAN.R-project.org/package=foreach">https://CRAN.R-project.org/package=foreach</a>.</p>
</div>
<div id="ref-wegert_visualcpx_2012">
<p>Wegert, Elias. 2012. <em>Visual Complex Functions. An Introduction with Phase Portraits</em>. Basel Heidelberg New York Dordrecht London: Springer.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Peter Biber.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
